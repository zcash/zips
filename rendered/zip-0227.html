<!DOCTYPE html>
<html>
<head>
    <title>ZIP 227: Issuance of Zcash Shielded Assets</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="css/style.css"></head>
<body>
    <section>
        <pre>ZIP: 227
Title: Issuance of Zcash Shielded Assets
Owners: Pablo Kogan &lt;pablo@qed-it.com&gt;
        Vivek Arte &lt;vivek@qed-it.com&gt;
        Daira-Emma Hopwood &lt;daira-emma@electriccoin.co&gt;
        Jack Grigg &lt;str4d@electriccoin.co&gt;
Credits: Daniel Benarroch
         Aurelien Nicolas
         Deirdre Connolly
         Teor
Status: Draft
Category: Consensus
Created: 2022-05-01
License: MIT
Discussions-To: &lt;<a href="https://github.com/zcash/zips/issues/618">https://github.com/zcash/zips/issues/618</a>&gt;
Pull-Request: &lt;<a href="https://github.com/zcash/zips/pull/680">https://github.com/zcash/zips/pull/680</a>&gt;</pre>
        <section id="terminology"><h2><span class="section-heading">Terminology</span><span class="section-anchor"> <a rel="bookmark" href="#terminology"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>The key words "MUST", "MUST NOT", "SHOULD", "RECOMMENDED", and "MAY" in this document are to be interpreted as described in BCP 14 <a id="footnote-reference-1" class="footnote_reference" href="#bcp14">1</a> when, and only when, they appear in all capitals.</p>
            <p>The term "network upgrade" in this document is to be interpreted as described in ZIP 200 <a id="footnote-reference-2" class="footnote_reference" href="#zip-0200">7</a>.</p>
            <p>The terms "Orchard" and "Action" in this document are to be interpreted as described in ZIP 224 <a id="footnote-reference-3" class="footnote_reference" href="#zip-0224">9</a>.</p>
            <p>We define the following additional terms:</p>
            <ul>
                <li>Asset: A type of note that can be transferred on the Zcash blockchain. Each Asset is identified by an Asset Identifier <a href="#specification-asset-identifier-asset-digest-and-asset-base">Specification: Asset Identifier, Asset Digest, and Asset Base</a>.
                    <ul>
                        <li>ZEC is the default (and currently the only defined) Asset for the Zcash mainnet.</li>
                        <li>TAZ is the default (and currently the only defined) Asset for the Zcash testnet.</li>
                        <li>We use the term "Custom Asset" to refer to any Asset other than ZEC and TAZ.</li>
                    </ul>
                </li>
                <li>Native Asset: a Custom Asset with issuance defined on the Zcash blockchain.</li>
                <li>Wrapped Asset: a Custom Asset with native issuance defined outside the Zcash blockchain.</li>
                <li>Issuance Action: an instance of a single issuance of a Zcash Shielded Asset. It defines the issuance of a single Asset Identifier.</li>
                <li>Issuance Bundle: the bundle in the transaction that contains all the issuance actions of that transaction.</li>
            </ul>
        </section>
        <section id="abstract"><h2><span class="section-heading">Abstract</span><span class="section-anchor"> <a rel="bookmark" href="#abstract"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>This ZIP (ZIP 227) proposes the Orchard Zcash Shielded Assets (OrchardZSA) protocol, in conjunction with ZIP 226 <a id="footnote-reference-4" class="footnote_reference" href="#zip-0226">10</a>. This protocol is an extension of the Orchard protocol that enables the creation, transfer and burn of Custom Assets on the Zcash chain. The creation of such Assets is defined in this ZIP (ZIP 227), while the transfer and burn of such Assets is defined in ZIP 226 <a id="footnote-reference-5" class="footnote_reference" href="#zip-0226">10</a>. This ZIP must only be implemented in conjunction with ZIP 226 <a id="footnote-reference-6" class="footnote_reference" href="#zip-0226">10</a>. The proposed issuance mechanism is only valid for the OrchardZSA transfer protocol, because it produces notes that can only be transferred via this protocol.</p>
        </section>
        <section id="motivation"><h2><span class="section-heading">Motivation</span><span class="section-anchor"> <a rel="bookmark" href="#motivation"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>This ZIP introduces the issuance mechanism for Custom Assets on the Zcash chain. While originally part of a single ZSA ZIP, the issuance mechanism turned out to be substantial enough to stand on its own and justify the creation of this supporting ZIP for ZIP 226 <a id="footnote-reference-7" class="footnote_reference" href="#zip-0226">10</a>.</p>
            <p>This ZIP only enables <em>transparent</em> issuance. As a first step, transparency will allow for proper testing of the applications that will be most used in the Zcash ecosystem, and will enable the supply of Assets to be tracked.</p>
            <p>The issuance mechanism described in this ZIP is broad enough for issuers to either create Assets on Zcash (i.e. Assets that originate on the Zcash blockchain), as well as for institutions to create bridges from other chains and import Wrapped Assets. This enables what we hope will be a useful set of applications.</p>
        </section>
        <section id="use-cases"><h2><span class="section-heading">Use Cases</span><span class="section-anchor"> <a rel="bookmark" href="#use-cases"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>The design presented in this ZIP enables issuance of shielded Assets in various modes:</p>
            <ul>
                <li>The issuer may or may not know the receivers of the issued Asset in advance.</li>
                <li>The Asset can be of non-fungible type, where each Asset type can be made part of a single “series”.</li>
                <li>The supply of the Asset can be limited in advance or not.</li>
                <li>The Asset can be a wrapped version of an Asset issued by another chain (as long as there is a bridge that supports transfer of that Asset between chains).</li>
            </ul>
            <p>See the <a href="#concrete-applications">Concrete Applications</a> section for more details.</p>
        </section>
        <section id="requirements"><h2><span class="section-heading">Requirements</span><span class="section-anchor"> <a rel="bookmark" href="#requirements"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <ul>
                <li>Any user of the Zcash blockchain can issue Custom Assets on chain.</li>
                <li>The issuance mechanism should enable public tracking of the supply of the Assets on the Zcash blockchain.</li>
                <li>Issuing or changing the attributes of a specific Asset should require cryptographic authorization.</li>
                <li>The Asset identification should be unique (among all shielded pools) and different issuer public keys should not be able to generate the same Asset Identifier.</li>
                <li>An issuer should be able to issue different Assets in the same transaction. In other words, in a single "issuance bundle", the issuer should be able publish many "issuance actions", potentially creating multiple Custom Assets.</li>
                <li>Every "issuance action" should contain a
                    <span class="math">\(\mathsf{finalize}\)</span>
                 boolean that defines whether the specific Custom Asset can have further tokens issued or not.</li>
            </ul>
        </section>
        <section id="specification-issuance-keys-and-issuance-authorization-signature-scheme"><h2><span class="section-heading">Specification: Issuance Keys and Issuance Authorization Signature Scheme</span><span class="section-anchor"> <a rel="bookmark" href="#specification-issuance-keys-and-issuance-authorization-signature-scheme"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>The OrchardZSA Protocol adds the following keys to the key components <a id="footnote-reference-8" class="footnote_reference" href="#protocol-addressesandkeys">25</a> <a id="footnote-reference-9" class="footnote_reference" href="#protocol-orchardkeycomponents">28</a>:</p>
            <ol type="1">
                <li>The issuance authorizing key, denoted as
                    <span class="math">\(\mathsf{isk}\!\)</span>
                , is the key used to authorize the issuance of Asset Identifiers by a given issuer, and is only used by that issuer.</li>
                <li>The issuance validating key, denoted as
                    <span class="math">\(\mathsf{ik}\!\)</span>
                , is the key that is used to validate issuance transactions. This key is used to validate the issuance of Asset Identifiers by a given issuer, and is used by all blockchain users (specifically the owners of notes for that Asset, and consensus validators) to associate the Asset in question with the issuer.</li>
            </ol>
            <p>The relations between these keys are shown in the following diagram:</p>
            <figure class="align-center" align="center">
                <img width="450" src="assets/images/zip-0227-key-components-zsa.png" alt="" />
                <figcaption>Diagram of Issuance Key Components for the OrchardZSA Protocol</figcaption>
            </figure>
            <section id="issuance-authorization-signature-scheme"><h3><span class="section-heading">Issuance Authorization Signature Scheme</span><span class="section-anchor"> <a rel="bookmark" href="#issuance-authorization-signature-scheme"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>The issuance authorization signature
                    <span class="math">\(\mathsf{issueAuthSig}\)</span>
                 is used to authorize the issuance of Custom Assets by the issuer. The issuance authorization signature scheme,
                    <span class="math">\(\mathsf{IssueAuthSig}\!\)</span>
                , comprises of all the associated types and algorithms defined in the protocol specification <a id="footnote-reference-10" class="footnote_reference" href="#protocol-abstractsig">27</a>.</p>
                <p>Batch verification MAY be used. Precomputation MAY be used if and only if it produces equivalent results.</p>
                <section id="orchard-zsa-issuance-authorization-signature-scheme"><h4><span class="section-heading">Orchard ZSA Issuance Authorization Signature Scheme</span><span class="section-anchor"> <a rel="bookmark" href="#orchard-zsa-issuance-authorization-signature-scheme"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h4>
                    <p>In the OrchardZSA protocol, we instantiate the issuance authorization signature scheme
                        <span class="math">\(\mathsf{IssueAuthSig}\)</span>
                     as a BIP-340 Schnorr signature over the secp256k1 curve. We define the constants as per the secp256k1 standard parameters, as described in BIP 340. The encodings of the signature and the public key differ slightly from that of BIP 340, and we specify the changes in what follows.</p>
                    <p>The associated types of the
                        <span class="math">\(\mathsf{IssueAuthSig}\)</span>
                     signature scheme are as follows:</p>
                    <ul>
                        <li>
                            <span class="math">\(\mathsf{IssueAuthSig.Message} = \mathbb{B}^{\mathbb{Y}^{[\mathbb{N}]}}\)</span>
                        </li>
                        <li>
                            <span class="math">\(\mathsf{IssueAuthSig.Signature} = \mathbb{B}^{\mathbb{Y}^{[65]}} \cup \{\bot\}\)</span>
                        </li>
                        <li>
                            <span class="math">\(\mathsf{IssueAuthSig.Public} = \mathbb{B}^{\mathbb{Y}^{[33]}} \cup \{\bot\}\)</span>
                        </li>
                        <li>
                            <span class="math">\(\mathsf{IssueAuthSig.Private} = \mathbb{B}^{\mathbb{Y}^{[32]}}\)</span>
                        </li>
                    </ul>
                    <p>where
                        <span class="math">\(\mathbb{B}^{\mathbb{Y}^{[k]}}\)</span>
                     denotes the set of sequences of
                        <span class="math">\(k\)</span>
                     bytes, and
                        <span class="math">\(\mathbb{B}^{\mathbb{Y}^{[\mathbb{N}]}}\)</span>
                     denotes the type of byte sequences of arbitrary length, as defined in the Zcash protocol specification <a id="footnote-reference-11" class="footnote_reference" href="#protocol-notation">24</a>.</p>
                    <p>The issuance authorizing key generation algorithm and the issuance validating key derivation algorithm are defined in the <a href="#issuance-key-derivation">Issuance Key Derivation</a> section, while the corresponding signing and validation algorithms are defined in the <a href="#issuance-authorization-signing-and-validation">Issuance Authorization Signing and Validation</a> section.</p>
                </section>
            </section>
            <section id="issuance-key-derivation"><h3><span class="section-heading">Issuance Key Derivation</span><span class="section-anchor"> <a rel="bookmark" href="#issuance-key-derivation"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <section id="issuance-authorizing-key-generation-for-hierarchical-deterministic-wallets"><h4><span class="section-heading">Issuance authorizing key generation for hierarchical deterministic wallets</span><span class="section-anchor"> <a rel="bookmark" href="#issuance-authorizing-key-generation-for-hierarchical-deterministic-wallets"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h4>
                    <p>The issuance authorizing key is generated using the Hardened-only key derivation process defined in ZIP 32 <a id="footnote-reference-12" class="footnote_reference" href="#zip-0032-hardened-only-key-derivation">3</a>. For the
                        <span class="math">\(\mathsf{Issuance}\)</span>
                     context, we define the following constants:</p>
                    <ul>
                        <li>
                            <span class="math">\(\mathsf{Issuance.MKGDomain} := \texttt{“ZcashSA\_Issue\_V1”}\)</span>
                        </li>
                        <li>
                            <span class="math">\(\mathsf{Issuance.CKDDomain} := \mathtt{0x81}\)</span>
                        </li>
                    </ul>
                    <p>Let
                        <span class="math">\(S\)</span>
                     be a seed byte sequence of a chosen length, which MUST be at least 32 and at most 252 bytes. We define the master extended issuance key
                        <span class="math">\(m_{\mathsf{Issuance}} := \mathsf{MKGh}^{\mathsf{Issuance}}(S)\!\)</span>
                    .</p>
                    <p>We use hardened-only child key derivation as defined in ZIP 32 <a id="footnote-reference-13" class="footnote_reference" href="#zip-0032-hardened-only-child-key-derivation">4</a> for the issuance authorizing key.</p>
                    <p>
                        <span class="math">\(\mathsf{CKDsk}((\mathsf{sk}_{par},\mathsf{c}_{par}), i) \rightarrow (\mathsf{sk}_{i}, \mathsf{c}_{i})\)</span>
                     :</p>
                    <ul>
                        <li>Return
                            <span class="math">\(\mathsf{CKDh}^{\mathsf{Issuance}}((\mathsf{sk}_{par},\mathsf{c}_{par}), i)\)</span>
                        </li>
                    </ul>
                    <p>We use the notation of ZIP 32 <a id="footnote-reference-14" class="footnote_reference" href="#zip-0032-orchard-key-path">6</a> for shielded HD paths, and define the issuance authorizing key path as
                        <span class="math">\(m_{\mathsf{Issuance}} / \mathit{purpose}' / \mathit{coin\_type}' / \mathit{account}'.\)</span>
                     We fix the path levels as follows:</p>
                    <ul>
                        <li>
                            <span class="math">\(\mathit{purpose}\!\)</span>
                        : a constant set to
                            <span class="math">\(227\)</span>
                         (i.e.
                            <span class="math">\(\mathtt{0xe3}\!\)</span>
                        ).
                            <span class="math">\(\mathit{purpose}'\)</span>
                         is thus
                            <span class="math">\(227'\)</span>
                         (or
                            <span class="math">\(\mathtt{0x800000e3}\!\)</span>
                        ) following the BIP 43 recommendation. <a id="footnote-reference-15" class="footnote_reference" href="#bip-0043">22</a></li>
                        <li>
                            <span class="math">\(\mathit{coin\_type}\!\)</span>
                        : Defined as in ZIP 32 <a id="footnote-reference-16" class="footnote_reference" href="#zip-0032-key-path-levels">5</a>.</li>
                        <li>
                            <span class="math">\(\mathit{account}\!\)</span>
                        : fixed to index
                            <span class="math">\(0\!\)</span>
                        .</li>
                    </ul>
                    <p>From the generated
                        <span class="math">\((\mathsf{sk}, \mathsf{c})\!\)</span>
                    , we set the issuance authorizing key to be
                        <span class="math">\(\mathsf{isk} := \mathsf{sk}\!\)</span>
                    .</p>
                </section>
                <section id="derivation-of-issuance-validating-key"><h4><span class="section-heading">Derivation of issuance validating key</span><span class="section-anchor"> <a rel="bookmark" href="#derivation-of-issuance-validating-key"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h4>
                    <p>Define
                        <span class="math">\(\mathsf{IssueAuthSig.DerivePublic} \;{\small ⦂}\; (\mathsf{isk} \;{\small ⦂}\; \mathsf{IssueAuthSig.Private}) \to \mathsf{IssueAuthSig.Public}\)</span>
                     as:</p>
                    <ul>
                        <li>
                            <span class="math">\(\mathsf{ik} := \mathtt{0x00} || \textit{PubKey}(\mathsf{isk})\)</span>
                        </li>
                        <li>Return
                            <span class="math">\(\bot\)</span>
                         if the
                            <span class="math">\(\textit{PubKey}\)</span>
                         algorithm invocation fails, otherwise return
                            <span class="math">\(\mathsf{ik}\!\)</span>
                        .</li>
                    </ul>
                    <p>where the
                        <span class="math">\(\textit{PubKey}\)</span>
                     algorithm is defined in BIP 340 <a id="footnote-reference-17" class="footnote_reference" href="#bip-0340">23</a>, and the output of the algorithm is in big-endian order as defined in BIP 340. The encoding of
                        <span class="math">\(\mathsf{ik}\)</span>
                     begins with a version byte that is
                        <span class="math">\(\mathtt{0x00}\!\)</span>
                    . This enables future ZIPs to specify alternative signature schemes.</p>
                    <p>It is possible for the
                        <span class="math">\(\textit{PubKey}\)</span>
                     algorithm to fail with very low probability, which means that
                        <span class="math">\(\mathsf{IssueAuthSig.DerivePublic}\)</span>
                     could return
                        <span class="math">\(\bot\)</span>
                     with very low probability. If this happens, discard the keys and repeat with a different
                        <span class="math">\(\mathsf{isk}\!\)</span>
                    .</p>
                    <p>This allows the issuer to use the same wallet it usually uses to transfer Assets, while keeping a disconnect from the other keys. Specifically, this method is aligned with the requirements and motivation of ZIP 32 <a id="footnote-reference-18" class="footnote_reference" href="#zip-0032">2</a>. It provides further anonymity and the ability to delegate issuance of an Asset (or in the future, generate a multi-signature protocol) while the rest of the keys remain in the wallet safe.</p>
                </section>
            </section>
            <section id="issuance-authorization-signing-and-validation"><h3><span class="section-heading">Issuance Authorization Signing and Validation</span><span class="section-anchor"> <a rel="bookmark" href="#issuance-authorization-signing-and-validation"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>Define
                    <span class="math">\(\mathsf{IssueAuthSig.Sign} \;{\small ⦂}\; (\mathsf{isk} \;{\small ⦂}\; \mathsf{IssueAuthSig.Private}) \times (M \;{\small ⦂}\; \mathsf{IssueAuthSig.Message}) \to \mathsf{IssueAuthSig.Signature}\)</span>
                 as:</p>
                <ul>
                    <li>Let the auxiliary data
                        <span class="math">\(a = [\mathtt{0x00}]^{32}\!\)</span>
                    .</li>
                    <li>Let
                        <span class="math">\(\text{σ} = \mathtt{0x00} || \mathsf{Sign}(\mathsf{isk}, M)\!\)</span>
                    .</li>
                    <li>Return
                        <span class="math">\(\bot\)</span>
                     if the
                        <span class="math">\(\mathsf{Sign}\)</span>
                     algorithm fails in the previous step, otherwise return
                        <span class="math">\(\text{σ}\!\)</span>
                    .</li>
                </ul>
                <p>where the
                    <span class="math">\(\mathsf{Sign}\)</span>
                 algorithm is defined in BIP 340 and
                    <span class="math">\(a\)</span>
                 denotes the auxiliary data used in BIP 340 <a id="footnote-reference-19" class="footnote_reference" href="#bip-0340">23</a>. Note that
                    <span class="math">\(\mathsf{IssueAuthSig.Sign}\)</span>
                 could return
                    <span class="math">\(\bot\)</span>
                 with very low probability. Note that the initial
                    <span class="math">\(\mathtt{0x00}\)</span>
                 byte in the signature is a version byte, enabling future ZIPs to specify alternative issuance authorization signature schemes.</p>
                <p>Define
                    <span class="math">\(\mathsf{IssueAuthSig.Validate} \;{\small ⦂}\; (\mathsf{ik} \;{\small ⦂}\; \mathsf{IssueAuthSig.Public}) \times (M \;{\small ⦂}\; \mathsf{IssueAuthSig.Message}) \times (\text{σ} \;{\small ⦂}\; \mathsf{IssueAuthSig.Signature}) \to \mathbb{B}\)</span>
                 as:</p>
                <ul>
                    <li>Return
                        <span class="math">\(0\)</span>
                     if
                        <span class="math">\(\text{σ} = \bot\!\)</span>
                    .</li>
                    <li>Parse
                        <span class="math">\(\text{σ}\)</span>
                     as
                        <span class="math">\(\mathtt{0x00} || \mathsf{sig}\)</span>
                     and parse
                        <span class="math">\(\mathsf{ik}\)</span>
                     as
                        <span class="math">\(\mathtt{0x00} || \mathsf{key}\!\)</span>
                    . Return
                        <span class="math">\(0\)</span>
                     if the parsing fails.</li>
                    <li>Return
                        <span class="math">\(1\)</span>
                     if
                        <span class="math">\(\mathsf{Verify}(\mathsf{key}, M, \mathsf{sig})\)</span>
                     succeeds, otherwise
                        <span class="math">\(0\!\)</span>
                    .</li>
                </ul>
                <p>where the
                    <span class="math">\(\mathsf{Verify}\)</span>
                 algorithm is defined in BIP 340 <a id="footnote-reference-20" class="footnote_reference" href="#bip-0340">23</a>.</p>
            </section>
        </section>
        <section id="specification-asset-identifier-asset-digest-and-asset-base"><h2><span class="section-heading">Specification: Asset Identifier, Asset Digest, and Asset Base</span><span class="section-anchor"> <a rel="bookmark" href="#specification-asset-identifier-asset-digest-and-asset-base"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>The definition of the Asset Identifier, and that of the Asset Digest and Asset Base for a given Asset Identifier, will be described in this section. For context, the relations between the Asset Identifier, Asset Digest, and Asset Base are shown in the following diagram:</p>
            <figure class="align-center" align="center">
                <img width="600" src="assets/images/zip-0227-asset-identifier-relation.png" alt="" />
                <figcaption>Diagram relating the Asset Identifier, Asset Digest, and Asset Base.</figcaption>
            </figure>
            <p><strong>Note:</strong> To keep notations light and concise, we may omit
                <span class="math">\(\mathsf{AssetId}\)</span>
             in the subscript when the Asset Identifier is clear from the context.</p>
            <section id="asset-identifiers"><h3><span class="section-heading">Asset Identifiers</span><span class="section-anchor"> <a rel="bookmark" href="#asset-identifiers"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>Every Asset has a globally-unique Asset Identifier, denoted
                    <span class="math">\(\mathsf{AssetId}\!\)</span>
                . A given Asset Identifier is used across all Zcash protocols that support ZSAs -- that is, the OrchardZSA protocol and potentially future Zcash shielded protocols.</p>
                <section id="zip-227-asset-identifiers"><h4><span class="section-heading">ZIP 227 Asset Identifiers</span><span class="section-anchor"> <a rel="bookmark" href="#zip-227-asset-identifiers"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h4>
                    <p>Assets issued using the protocol specified in this ZIP are scoped to the
                        <span class="math">\(\mathsf{ik}\)</span>
                     that issued them. Within that scope, Asset Identifier uniqueness is obtained by way of an asset description,
                        <span class="math">\(\mathsf{asset\_desc}\!\)</span>
                    , which includes any information pertaining to the issuance.
                        <span class="math">\(\mathsf{asset\_desc}\)</span>
                     is a non-empty byte sequence which SHOULD be a well-formed UTF-8 code unit sequence according to Unicode 15.0.0 or later.</p>
                    <p>Define</p>
                    <div class="math">\(\mathsf{assetDescHash} := \textsf{BLAKE2b-256}(\texttt{“ZSA-AssetDescCRH”},\; \mathsf{asset\_desc}),\)</div>
                    <p>We define Asset Identifiers for Assets issued under this ZIP as</p>
                    <div class="math">\(\mathsf{AssetId} := (\mathsf{ik}, \mathsf{assetDescHash})\)</div>
                    <p>and define their canonical encoding as</p>
                    <div class="math">\(\mathsf{EncodeAssetId}(\mathsf{AssetId}) = \mathsf{EncodeAssetId}((\mathsf{ik}, \mathsf{assetDescHash})) := \mathtt{0x00} || \mathsf{ik} || \mathsf{assetDescHash}\)</div>
                    <p>Note that the initial
                        <span class="math">\(\mathtt{0x00}\)</span>
                     byte is a version byte, enabling future ZIPs to specify alternative issuance protocols and Asset Identifiers.</p>
                    <p>Wallets MUST NOT display just the
                        <span class="math">\(\mathsf{asset\_desc}\)</span>
                     string to their users as the name of the Asset. Some possible alternatives include:</p>
                    <ul>
                        <li>Wallets could allow clients to provide an additional configuration file that stores a one-to-one mapping of names to Asset Identifiers via a petname system. This allows clients to rename the Assets in a way they find useful. Default versions of this file with well-known Assets listed can be made available online as a starting point for clients.</li>
                        <li>The Asset Digest could be used as a more compact bytestring to uniquely determine an Asset, and wallets could support clients scanning QR codes to load Asset information into their wallets.</li>
                    </ul>
                </section>
            </section>
            <section id="asset-digests"><h3><span class="section-heading">Asset Digests</span><span class="section-anchor"> <a rel="bookmark" href="#asset-digests"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>From the Asset Identifier, we derive an Asset Digest</p>
                <div class="math">\(\mathsf{AssetDigest_{AssetId}} := \textsf{BLAKE2b-512}(\texttt{“ZSA-Asset-Digest”},\; \mathsf{EncodeAssetId}(\mathsf{AssetId})),\)</div>
                <p>where
                    <span class="math">\(\mathsf{EncodeAssetId}(\mathsf{AssetId})\)</span>
                 is the canonical encoding scheme for the Asset Identifier.</p>
            </section>
            <section id="asset-bases"><h3><span class="section-heading">Asset Bases</span><span class="section-anchor"> <a rel="bookmark" href="#asset-bases"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>From the Asset Digest, we derive a specific Asset Base that represents the Custom Asset within each shielded protocol:</p>
                <div class="math">\(\mathsf{AssetBase_{AssetId}} := \mathsf{ZSAValueBase}(\mathsf{AssetDigest_{AssetId}})\)</div>
                <p>This Asset Base is included in shielded notes within the shielded protocol.</p>
                <section id="orchardzsa-asset-bases"><h4><span class="section-heading">OrchardZSA Asset Bases</span><span class="section-anchor"> <a rel="bookmark" href="#orchardzsa-asset-bases"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h4>
                    <p>In the case of the OrchardZSA protocol, we define</p>
                    <div class="math">\(\mathsf{ZSAValueBase}(\mathsf{AssetDigest}) := \mathsf{GroupHash}^\mathbb{P}(\texttt{"z.cash:OrchardZSA"}, \mathsf{AssetDigest})\)</div>
                    <p>where
                        <span class="math">\(\mathsf{GroupHash}^\mathbb{P}\)</span>
                     is defined as in <a id="footnote-reference-21" class="footnote_reference" href="#protocol-concretegrouphashpallasandvesta">32</a>.</p>
                    <figure class="align-center" align="center">
                        <img width="800" src="assets/images/zip-0227-asset-identifier-relation-orchard-zsa.png" alt="" />
                        <figcaption>Diagram relating the Issuance validating key, asset description, asset description hash, Asset Identifier, Asset Digest, and Asset Base for the OrchardZSA Protocol.</figcaption>
                    </figure>
                </section>
            </section>
        </section>
        <section id="specification-issue-note-issuance-action-issuance-bundle-and-issuance-protocol"><h2><span class="section-heading">Specification: Issue Note, Issuance Action, Issuance Bundle and Issuance Protocol</span><span class="section-anchor"> <a rel="bookmark" href="#specification-issue-note-issuance-action-issuance-bundle-and-issuance-protocol"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <section id="issue-note"><h3><span class="section-heading">Issue Note</span><span class="section-anchor"> <a rel="bookmark" href="#issue-note"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>Let
                    <span class="math">\(\ell_{\mathsf{value}}\)</span>
                 be as defined in §5.3 of the protocol specification <a id="footnote-reference-22" class="footnote_reference" href="#protocol-constants">30</a>. An Issue Note represents that a value
                    <span class="math">\(\mathsf{v} : \{0 .. 2^{\ell_{\mathsf{value}}} - 1\}\)</span>
                 of a specific Custom Asset is issued to a recipient. An Issue Note is a tuple
                    <span class="math">\((\mathsf{d}, \mathsf{pk_d}, \mathsf{v}, \mathsf{AssetBase}, \text{ρ}, \mathsf{rseed})\!\)</span>
                , where:</p>
                <ul>
                    <li>
                        <span class="math">\(\mathsf{d}: \mathbb{B}^{[\ell_{\mathsf{d}}]}\)</span>
                     is the diversifier of the recipient's shielded payment address, as in §3.2 of the protocol specification <a id="footnote-reference-23" class="footnote_reference" href="#protocol-notes">26</a>.</li>
                    <li>
                        <span class="math">\(\mathsf{pk_d}: \mathsf{KA}^{\mathsf{Orchard}}.\mathsf{Public}\)</span>
                     is the recipient's diversified transmission key, as in §3.2 of the protocol specification <a id="footnote-reference-24" class="footnote_reference" href="#protocol-notes">26</a>.</li>
                    <li>
                        <span class="math">\(\mathsf{v} : \{0 .. 2^{\ell_{\mathsf{value}}} - 1\}\)</span>
                     is the value of the note in terms of the number of Asset tokens.</li>
                    <li>
                        <span class="math">\(\mathsf{AssetBase}: \mathbb{P}^*\)</span>
                     is the Asset Base corresponding to the ZSA being issued in the Issue Note.</li>
                    <li>
                        <span class="math">\(\text{ρ}: \mathbb{F}_{q_{\mathbb{P}}}\)</span>
                     is used to derive the nullifier of the note, and is computed as in <a href="#computation-of">Computation of ρ</a>.</li>
                    <li>
                        <span class="math">\(\mathsf{rseed}: \mathbb{B}^{[\mathbb{Y}^{32}]}\)</span>
                     MUST be sampled uniformly at random by the issuer.</li>
                </ul>
                <p>ZIP 230 <a id="footnote-reference-25" class="footnote_reference" href="#zip-0230-issue-note">16</a> defines, in <code>IssueNote</code>, field encodings which together with
                    <span class="math">\(\mathsf{ik}\)</span>
                 from the parent <a href="#issuance-bundle">Issuance Bundle</a> and
                    <span class="math">\(\mathsf{AssetDescHash}\)</span>
                 from the parent <a href="#issuance-action">Issuance Action</a>, specify an Issue Note.</p>
                <p>Let
                    <span class="math">\(\mathsf{Note^{Issue}}\)</span>
                 be the type of an Issue Note, i.e.</p>
                <div class="math">\(\mathsf{Note^{Issue}} := \mathbb{B}^{[\ell_{\mathsf{d}}]} \times \mathsf{KA}^{\mathsf{Orchard}}.\mathsf{Public} \times \{0 .. 2^{\ell_{\mathsf{value}}} - 1\} \times \mathbb{P}^* \times \mathbb{F}_{q_{\mathbb{P}}} \times \mathbb{B}^{[\mathbb{Y}^{32}]}.\)</div>
                <p>The note commitments of Issue Notes are computed in the same manner as for OrchardZSA Notes. They will be added to the note commitment tree as any other shielded note when the transaction issuing the Asset is included on chain. This prevents future usage of the note from being linked to the issuance transaction, as the nullifier key is not known to the validators and chain observers.</p>
            </section>
            <section id="issuance-action"><h3><span class="section-heading">Issuance Action</span><span class="section-anchor"> <a rel="bookmark" href="#issuance-action"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>An issuance action, <code>IssueAction</code>, is the instance of issuing a specific Custom Asset, and contains the following fields:</p>
                <ul>
                    <li><code>assetDescHash</code>: the hash of the Asset description, as defined in the <a href="#zip-227-asset-identifiers">ZIP 227 Asset Identifiers</a> section.</li>
                    <li><code>vNotes</code>: an array of Issue Notes containing the unencrypted output notes to the recipients of the Asset.</li>
                    <li><code>flagsIssuance</code>: a byte that stores the
                        <span class="math">\(\mathsf{finalize}\)</span>
                     boolean that defines whether the issuance of that specific Custom Asset is finalized or not.</li>
                </ul>
                <p>The
                    <span class="math">\(\mathsf{finalize}\)</span>
                 boolean is set by the Issuer to signal that there will be no further issuance of the specific Custom Asset. As we will see in <a href="#specification-consensus-rule-changes">Specification: Consensus Rule Changes</a>, transactions that attempt to issue further amounts of a Custom Asset that has previously been finalized will be rejected.</p>
                <p>The complete encoding of these fields into an <code>IssueAction</code> is defined in ZIP 230 <a id="footnote-reference-26" class="footnote_reference" href="#zip-0230-issuance-action-description">15</a>.</p>
            </section>
            <section id="issuance-bundle"><h3><span class="section-heading">Issuance Bundle</span><span class="section-anchor"> <a rel="bookmark" href="#issuance-bundle"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>An issuance bundle is the aggregate of all the issuance-related information. Specifically, contains all the issuance actions and the issuer signature on the transaction SIGHASH that validates the issuance itself. It contains the following fields:</p>
                <ul>
                    <li>
                        <span class="math">\(\mathsf{ik}\!\)</span>
                    : the issuance validating key, that allows the validators to verify that the
                        <span class="math">\(\mathsf{AssetId}\)</span>
                     is properly associated with the issuer.</li>
                    <li><code>vIssueActions</code>: an array of issuance actions, of type <code>IssueAction</code>.</li>
                    <li>
                        <span class="math">\(\mathsf{issueAuthSig}\!\)</span>
                    : the signature of the transaction SIGHASH, signed by the issuance authorizing key,
                        <span class="math">\(\mathsf{isk}\!\)</span>
                    , that validates the issuance.</li>
                </ul>
                <p>The issuance bundle is added within the transaction format as a new bundle. The detailed encoding of the issuance bundle as a part of the V6 transaction format is defined in ZIP 230 <a id="footnote-reference-27" class="footnote_reference" href="#zip-0230-transaction-format">17</a>.</p>
            </section>
            <section id="computation-of"><h3><span class="section-heading">Computation of ρ</span><span class="section-anchor"> <a rel="bookmark" href="#computation-of"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>We define a function
                    <span class="math">\(\mathsf{DeriveIssuedRho} : \mathbb{F}_{q_{\mathbb{P}}} \times \{0 .. 2^{32} - 1\} \times \{0 .. 2^{32} - 1\} \to \mathbb{F}_{q_{\mathbb{P}}}\)</span>
                 for Issue Notes in the OrchardZSA Protocol as follows:</p>
                <div class="math">\(\mathsf{DeriveIssuedRho}(\mathsf{nf}, \mathsf{i_{A}}, \mathsf{i_{N}}) := \mathsf{ToBase}^{\mathsf{Orchard}}(\mathsf{PRF}^{\mathsf{expand}}(\mathsf{I2LEOSP}_{256}(\mathsf{nf}), [\mathtt{0x84}] \| \mathsf{I2LEOSP}_{32}(\mathsf{i_{A}}) \| \mathsf{I2LEOSP}_{32}(\mathsf{i_{N}}))),\)</div>
                <p>where
                    <span class="math">\(\mathsf{ToBase}^{\mathsf{Orchard}}\)</span>
                 is defined in §4.2.3 of the protocol specification <a id="footnote-reference-28" class="footnote_reference" href="#protocol-orchardkeycomponents">28</a>, and
                    <span class="math">\(\mathsf{PRF}^{\mathsf{expand}}\)</span>
                 is defined in §5.4.2 of the protocol specification <a id="footnote-reference-29" class="footnote_reference" href="#protocol-concreteprfs">31</a>.</p>
                <p>The
                    <span class="math">\(\text{ρ}\)</span>
                 field of an Issue Note is computed as</p>
                <div class="math">\(\text{ρ} := \mathsf{DeriveIssuedRho}(\mathsf{nf}_{0,0}, \mathsf{index_{Action}}, \mathsf{index_{Note}}),\)</div>
                <p>where
                    <span class="math">\(\mathsf{nf}_{0,0}\)</span>
                 is the nullifier for the input note in the first Action in the first Action Group of the OrchardZSA Bundle of the transaction,
                    <span class="math">\(\mathsf{index_{Action}}\)</span>
                 is the zero-based index of the Issuance Action in the Issuance Bundle, and
                    <span class="math">\(\mathsf{index_{Note}}\)</span>
                 is the zero-based index of the Issue Note in the Issuance Action.</p>
                <p><strong>NOTE:</strong> This implicitly requires that there always is an Action Group in the OrchardZSA bundle of the transaction. This is enforced by the sixth consensus rule in the <a href="#specification-consensus-rule-changes">Specification: Consensus Rule Changes</a> section.</p>
            </section>
            <section id="issuance-protocol"><h3><span class="section-heading">Issuance Protocol</span><span class="section-anchor"> <a rel="bookmark" href="#issuance-protocol"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>The issuer program performs the following operations:</p>
                <p>For all actions <code>IssueAction</code>:</p>
                <ul>
                    <li>encode
                        <span class="math">\(\mathsf{asset\_desc}\)</span>
                     as a UTF-8 byte string.</li>
                    <li>compute
                        <span class="math">\(\mathsf{assetDescHash}\)</span>
                    </li>
                    <li>compute
                        <span class="math">\(\mathsf{AssetDigest}\)</span>
                     from the issuance validating key
                        <span class="math">\(\mathsf{ik}\)</span>
                     and
                        <span class="math">\(\mathsf{assetDescHash}\)</span>
                     as decribed in the <a href="#specification-asset-identifier-asset-digest-and-asset-base">Specification: Asset Identifier, Asset Digest, and Asset Base</a> section.</li>
                    <li>compute
                        <span class="math">\(\mathsf{AssetBase}\)</span>
                     from
                        <span class="math">\(\mathsf{AssetDigest}\)</span>
                     as decribed in the <a href="#specification-asset-identifier-asset-digest-and-asset-base">Specification: Asset Identifier, Asset Digest, and Asset Base</a> section.</li>
                    <li>set the
                        <span class="math">\(\mathsf{finalize}\)</span>
                     boolean as desired (if more issuance actions are to be created for this
                        <span class="math">\(\mathsf{AssetBase}\!\)</span>
                    , set
                        <span class="math">\(\mathsf{finalize} = 0\!\)</span>
                    , otherwise set
                        <span class="math">\(\mathsf{finalize} = 1\!\)</span>
                    ).</li>
                    <li>for each recipient
                        <span class="math">\(i\!\)</span>
                    :
                        <ul>
                            <li>generate an Issue Note,
                                <span class="math">\(\mathsf{note}_i = (\mathsf{d}_i, \mathsf{pk}_{\mathsf{d}_i}, \mathsf{v}_i, \mathsf{AssetBase}, \text{ρ}_i, \mathsf{rseed}_i)\!\)</span>
                            .</li>
                            <li>encode the
                                <span class="math">\(\mathsf{note}_i\)</span>
                             into the vector <code>vNotes</code> of the <code>IssueAction</code>.</li>
                        </ul>
                    </li>
                    <li>encode the <code>IssueAction</code> into the vector <code>vIssueActions</code> of the bundle.</li>
                </ul>
                <p>For the <code>IssueBundle</code>:</p>
                <ul>
                    <li>encode the <code>vIssueActions</code> vector.</li>
                    <li>encode the
                        <span class="math">\(\mathsf{ik}\)</span>
                     as 32 byte-string.</li>
                    <li>sign the SIGHASH transaction hash with the issuance authorizing key,
                        <span class="math">\(\mathsf{isk}\!\)</span>
                    , using the
                        <span class="math">\(\mathsf{IssueAuthSig}\)</span>
                     signature scheme. The signature is then added to the issuance bundle.</li>
                </ul>
                <p><strong>Note:</strong> The note commitment is not included in the <code>IssuanceAction</code> itself. As explained below, it is computed later by the validators and added to the note commitment tree.</p>
            </section>
        </section>
        <section id="specification-reference-notes-and-global-issuance-state"><h2><span class="section-heading">Specification: Reference Notes and Global Issuance State</span><span class="section-anchor"> <a rel="bookmark" href="#specification-reference-notes-and-global-issuance-state"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <section id="reference-notes"><h3><span class="section-heading">Reference Notes</span><span class="section-anchor"> <a rel="bookmark" href="#reference-notes"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>A reference note for a Custom Asset MUST be included by the issuer as the first Note in the Action of the Issuance Bundle where that Custom Asset is being issued for the first time.</p>
                <p>A reference note for a Custom Asset is an Issue Note where the value
                    <span class="math">\(\mathsf{v}\)</span>
                 is set to
                    <span class="math">\(0\!\)</span>
                , the Asset Base (
                    <span class="math">\(\mathsf{AssetBase}\!\)</span>
                ) corresponds to that of the Custom Asset, and the recipient address
                    <span class="math">\((\mathsf{d}, \mathsf{pk}_{\mathsf{d}})\)</span>
                 is set to the default diversified payment address (i.e. the diversified payment address with diversifier index
                    <span class="math">\(0\!\)</span>
                ) derived from the all-zero Orchard spending key using the algorithm specified in §4.2.3 of the protocol specification <a id="footnote-reference-30" class="footnote_reference" href="#protocol-orchardkeycomponents">28</a>. This corresponds to a 43 byte <code>u8</code> array with the following entries:</p>
                <pre>[
  204, 54, 96, 25, 89, 33, 59, 107, 12, 219, 150, 167, 92, 23, 195, 166, 104, 169, 127, 13, 106,
  140, 92, 225, 100, 165, 24, 234, 155, 169, 165, 14, 167, 81, 145, 253, 134, 27, 15, 241, 14,
  98, 176,
]</pre>
            </section>
            <section id="global-issuance-state"><h3><span class="section-heading">Global Issuance State</span><span class="section-anchor"> <a rel="bookmark" href="#global-issuance-state"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>The maximum total supply of any issued Custom Asset is denoted by the constant
                    <span class="math">\(\mathsf{MAX\_ISSUE} := 2^{64} - 1\!\)</span>
                . Issuance requires the following additions to the global state:</p>
                <p>A map,
                    <span class="math">\(\mathsf{issued\_assets} : \mathbb{P}^* \to \{0 .. \mathsf{MAX\_ISSUE}\} \times \mathbb{B} \times \mathsf{Note^{Issue}}\!\)</span>
                , from the Asset Base,
                    <span class="math">\(\mathsf{AssetBase} : \mathbb{P}^*\!\)</span>
                , to a tuple
                    <span class="math">\((\mathsf{balance}, \mathsf{final}, \mathsf{note_{ref}})\!\)</span>
                , for every Asset that has been issued. We use the notation
                    <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{balance}\!\)</span>
                ,
                    <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{final}\!\)</span>
                , and
                    <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{note_{ref}}\)</span>
                 to access, respectively, the elements of the tuple stored in the global state for a given
                    <span class="math">\(\mathsf{AssetBase}\!\)</span>
                . If
                    <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}) = \bot\!\)</span>
                , it is assumed that
                    <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{balance} = 0\!\)</span>
                ,
                    <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{final} = 0\!\)</span>
                , and
                    <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{note_{ref}} = \bot\!\)</span>
                .</p>
                <p>For any Asset represented by
                    <span class="math">\(\mathsf{AssetBase}\!\)</span>
                :</p>
                <ul>
                    <li>
                        <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{balance} \in \{0 .. \mathsf{MAX\_ISSUE}\}\)</span>
                     stores the amount of the Asset in circulation, computed as the amount of the Asset that has been issued less the amount of the Asset that has been burnt.</li>
                    <li>
                        <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{final} : \mathbb{B}\)</span>
                     is a Boolean that stores the finalization status of the Asset (i.e.: whether the
                        <span class="math">\(\mathsf{finalize}\)</span>
                     flag has been set to
                        <span class="math">\(1\)</span>
                     in any preceding issuance transaction for the Asset). The value of
                        <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{final}\)</span>
                     for any
                        <span class="math">\(\mathsf{AssetBase}\)</span>
                     cannot be changed from
                        <span class="math">\(1\)</span>
                     to
                        <span class="math">\(0\!\)</span>
                    .</li>
                    <li>
                        <span class="math">\(\mathsf{issued\_assets}(\mathsf{AssetBase}).\mathsf{note_{ref}} : \mathsf{Note^{Issue}}\)</span>
                     stores the reference note for the Asset, as defined in the <a href="#reference-notes">Reference Notes</a> section.</li>
                </ul>
                <p>The maximum total supply of any issued Custom Asset is denoted by the constant
                    <span class="math">\(\mathsf{MAX\_ISSUE} := 2^{64} - 1\!\)</span>
                .</p>
            </section>
            <section id="management-of-the-global-issuance-state"><h3><span class="section-heading">Management of the Global Issuance State</span><span class="section-anchor"> <a rel="bookmark" href="#management-of-the-global-issuance-state"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>The issuance state, that is, the
                    <span class="math">\(\mathsf{issued\_assets}\)</span>
                 map, MUST be updated by a node during the processing of any transaction that contains burn information, or an issuance bundle. The issuance state is chained as follows:</p>
                <ul>
                    <li>The input issuance state for the activation block of the OrchardZSA protocol is the empty map.</li>
                    <li>The input issuance state for the first transaction of a block is the final issuance state of the immediately preceding block.</li>
                    <li>The input issuance state of each subsequent transaction in the block is the output issuance state of the immediately preceding transaction.</li>
                    <li>The final issuance state of a block is the output issuance state of the last transaction in the block.</li>
                </ul>
                <p>We describe the consensus rule changes that govern the management of the global issuance state in the <a href="#specification-consensus-rule-changes">Specification: Consensus Rule Changes</a> section. We use
                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{IN}}\)</span>
                 and
                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}\)</span>
                 to denote the input issuance state and output issuance state for a transaction, respectively.</p>
            </section>
        </section>
        <section id="specification-consensus-rule-changes"><h2><span class="section-heading">Specification: Consensus Rule Changes</span><span class="section-anchor"> <a rel="bookmark" href="#specification-consensus-rule-changes"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>For every transaction:</p>
            <ul>
                <li>The <code>nActionGroupsOrchard</code> field MUST have a value of either <code>0</code> or <code>1</code> and the <code>nAGExpiryHeight</code> field MUST have a value of <code>0</code>.</li>
                <li>The output issuance state of the transaction MUST be initialized to be the same as the input issuance state,
                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}} = \mathsf{issued\_assets}_{\mathsf{IN}}\!\)</span>
                .</li>
                <li>The
                    <span class="math">\(\mathsf{assetBurn}\)</span>
                 set MUST satisfy the consensus rules specified in ZIP 226 <a id="footnote-reference-31" class="footnote_reference" href="#zip-0226-assetburn">12</a>.</li>
                <li>It MUST be the case that for all
                    <span class="math">\((\mathsf{AssetBase}, \mathsf{v}) \in \mathsf{assetBurn}\!\)</span>
                ,
                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}(\mathsf{AssetBase}).\mathsf{balance} \geq \mathsf{v}\!\)</span>
                . The node then MUST update
                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}(\mathsf{AssetBase})\)</span>
                 prior to processing the issuance bundle in the following manner. For every
                    <span class="math">\((\mathsf{AssetBase}, \mathsf{v}) \in \mathsf{AssetBurn}\!\)</span>
                ,
                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}(\mathsf{AssetBase}).\mathsf{balance} = \mathsf{issued\_assets}_{\mathsf{OUT}}(\mathsf{AssetBase}).\mathsf{balance} - \mathsf{v}\!\)</span>
                .</li>
                <li>Let
                    <span class="math">\(\mathsf{SigHash}\)</span>
                 be the SIGHASH transaction hash of this transaction, as defined in §4.10 of the protocol specification <a id="footnote-reference-32" class="footnote_reference" href="#protocol-sighash">29</a> with the modifications described in ZIP 226 <a id="footnote-reference-33" class="footnote_reference" href="#zip-0226-txiddigest">13</a>, using
                    <span class="math">\(\mathsf{SIGHASH\_ALL}\!\)</span>
                .</li>
                <li>If the transaction contains an Issuance Bundle, it MUST also contain at least one OrchardZSA Action Group.</li>
                <li>The issuance authorization signature,
                    <span class="math">\(\mathsf{issueAuthSig}\!\)</span>
                , MUST be a valid
                    <span class="math">\(\mathsf{IssueAuthSig}\)</span>
                 signature over
                    <span class="math">\(\mathsf{SigHash}\!\)</span>
                , i.e.
                    <span class="math">\(\mathsf{IssueAuthSig}.\!\mathsf{Validate}(\mathsf{ik}, \mathsf{SigHash}, \mathsf{issueAuthSig}) = 1\!\)</span>
                .</li>
                <li>For every issuance action description (
                    <span class="math">\(\mathsf{IssueAction}_\mathsf{i},\ 1 \leq i \leq \mathtt{nIssueActions}\!\)</span>
                ) in the issuance bundle:
                    <ul>
                        <li>Every Issue Note in <code>IssueAction</code> MUST be a valid encoding of the
                            <span class="math">\(\mathsf{Note^{Issue}}\)</span>
                         type, and MUST encode the same
                            <span class="math">\(\mathsf{AssetBase}\!\)</span>
                        .</li>
                        <li>This
                            <span class="math">\(\mathsf{AssetBase}\)</span>
                         MUST satisfy the derivation from the issuance validating key and asset description described in the <a href="#specification-asset-identifier-asset-digest-and-asset-base">Specification: Asset Identifier, Asset Digest, and Asset Base</a> section.</li>
                        <li>It MUST be the case that
                            <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}(\mathsf{AssetBase}).\mathsf{final} \neq 1\!\)</span>
                        .</li>
                        <li>If
                            <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}(\mathsf{AssetBase}).\mathsf{note_{ref}} = \bot\!\)</span>
                        , then let
                            <span class="math">\(\mathsf{note}_1\)</span>
                         be the first Issue Note in the Issuance Action.
                            <ul>
                                <li>The recipient address
                                    <span class="math">\((\mathsf{d}, \mathsf{pk}_{\mathsf{d}})\)</span>
                                 of
                                    <span class="math">\(\mathsf{note}_1\)</span>
                                 MUST be the default diversified payment address derived from the all-zero Orchard spending key, as described in the <a href="#reference-notes">Reference Notes</a> section.</li>
                                <li>The value
                                    <span class="math">\(\mathsf{v}_0\)</span>
                                 of
                                    <span class="math">\(\mathsf{note}_1\)</span>
                                 MUST be
                                    <span class="math">\(0\!\)</span>
                                .</li>
                                <li>The node MUST update
                                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}(\mathsf{AssetBase}).\mathsf{note_{ref}} = \mathsf{note}_1\!\)</span>
                                .</li>
                            </ul>
                        </li>
                        <li>For every issue note description (
                            <span class="math">\(\mathsf{note}_{\mathsf{j}},\ 1 \leq j \leq \mathtt{nNotes}\!\)</span>
                        ) in <code>IssueAction</code>:
                            <ul>
                                <li>The
                                    <span class="math">\(\text{ρ}\)</span>
                                 field of the issue note MUST have been computed as described in the <a href="#computation-of">Computation of ρ</a> section.</li>
                                <li>It MUST be the case that
                                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}.\mathsf{balance} + \mathsf{v} \leq \mathsf{MAX\_ISSUE}\!\)</span>
                                , where
                                    <span class="math">\(\mathsf{v}\)</span>
                                 is the value of
                                    <span class="math">\(\mathsf{note}_{\mathsf{j}}\!\)</span>
                                . The node then MUST update
                                    <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}.\mathsf{balance} = \mathsf{issued\_assets}_{\mathsf{OUT}}.\mathsf{balance} + \mathsf{v}\!\)</span>
                                .</li>
                                <li>The node MUST compute the note commitment,
                                    <span class="math">\(\mathsf{cm}_{\mathsf{i,j}}\!\)</span>
                                , as defined in the Note Structure and Commitment section of ZIP 226 <a id="footnote-reference-34" class="footnote_reference" href="#zip-0226-notestructure">11</a>.</li>
                            </ul>
                        </li>
                        <li>If
                            <span class="math">\(\mathsf{finalize} = 1\)</span>
                         within the <code>flagsIssuance</code> field of <code>IssueAction</code>, the node MUST set
                            <span class="math">\(\mathsf{issued\_assets}_{\mathsf{OUT}}(\mathsf{AssetBase}).\mathsf{final} = 1\!\)</span>
                        .</li>
                    </ul>
                </li>
            </ul>
            <section id="addition-to-the-note-commitment-tree"><h3><span class="section-heading">Addition to the Note Commitment Tree</span><span class="section-anchor"> <a rel="bookmark" href="#addition-to-the-note-commitment-tree"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>If the transaction is added to the block chain, the note commitments of all the OrchardZSA Notes and the Issue Notes in the transaction are added to the note commitment tree of the associated treestate. The order of addition to the tree is as specified below:</p>
                <ul>
                    <li>For each Action Group in the OrchardZSA Bundle:
                        <ul>
                            <li>For every Action in the Action Group, append the note commitment of every new OrchardZSA note in the Action to the note commitment tree.</li>
                        </ul>
                    </li>
                    <li>For each Issue Action in the Issue Bundle:
                        <ul>
                            <li>For every Issue Note in the Issue Action, append the note commitment of the Issue Note to the note commitment tree.</li>
                        </ul>
                    </li>
                </ul>
            </section>
        </section>
        <section id="rationale"><h2><span class="section-heading">Rationale</span><span class="section-anchor"> <a rel="bookmark" href="#rationale"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>The following is a list of rationale for different decisions made in the proposal:</p>
            <ul>
                <li>The issuance key structure is independent of the original key tree, but derived in an analogous manner (via ZIP 32). This keeps the issuance details and the Asset Identifiers consistent across multiple shielded pools. It also separates the issuance authority from the spend authority, allowing for the potential transfer of issuance authority without compromising the spend authority.</li>
                <li>The Custom Asset is described via a combination of the issuance validating key and an asset description string, to preclude the possibility of two different issuers creating colliding Custom Assets.</li>
                <li>The requirement of at least one OrchardZSA Action Group in the presence of an issue bundle is both to allow for the computation of the
                    <span class="math">\(\text{ρ}\)</span>
                 field of the issue notes, as well as to prevent replay attacks. If a transaction includes only an issue bundle, the SIGHASH transaction hash would be computed solely based on the issue bundle. A duplicate bundle would have the same SIGHASH transaction hash, potentially allowing for a replay attack.</li>
            </ul>
            <section id="hash-of-the-asset-description"><h3><span class="section-heading">Hash of the asset description</span><span class="section-anchor"> <a rel="bookmark" href="#hash-of-the-asset-description"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>In an earlier version of this ZIP, the asset description was a direct component of the Asset Identifier, and was stored on-chain in each issuance transaction. The Asset Identifier and issuance transactions now instead include a collision-resistant hash of the asset description, for the following reasons:</p>
                <ul>
                    <li>A hash output (32 bytes per Issue Action) incurs lower average bandwidth costs in issuance transactions than the asset description (previously up to 512 bytes).</li>
                    <li>The asset description can be longer than 512 bytes without incurring chain costs.</li>
                    <li>Including an asset description byte string directly in issuance transactions does not ensure that the "user-visible" asset description is consensus-visible, because the byte string could itself be a hash of another off-chain description (even if the consensus rules had required it to be a Unicode string instead of only recommending it).</li>
                    <li>The lack of key rotation in this issuance protocol means that it is not sufficient to mark an
                        <span class="math">\(\mathsf{ik}\)</span>
                     as trusted and then accept whatever asset descriptions are issued by it. Each Asset Identifier needs to be independently verified, which requires some out-of-band protocol that can also convey the corresponding asset description.</li>
                    <li>If issuance transactions include the asset descriptions directly, wallets will discover them during scanning. This is an "attractive nuisance" because it would result in wallets being more likely to expose the asset description directly to users without any verification that the received asset has the value that a user might expect from that description. By instead using a collision-resistant hash of an asset description, wallets are forced to look up the corresponding asset description when a payment is received in an unknown asset. That lookup can be mediated by a trusted party or common trusted registry of known assets, or else will need to be approved directly by a user who can personally assert their interest in that specific asset.</li>
                </ul>
            </section>
            <section id="rationale-for-global-issuance-state"><h3><span class="section-heading">Rationale for Global Issuance State</span><span class="section-anchor"> <a rel="bookmark" href="#rationale-for-global-issuance-state"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>It is necessary to ensure that the balance of any issued Custom Asset never becomes negative within a shielded pool, along the lines of ZIP 209 <a id="footnote-reference-35" class="footnote_reference" href="#zip-0209">8</a>. However, unlike for the shielded ZEC pools, there is no individual transaction field that directly corresponds to both the issued and burnt amounts for a given Asset. Therefore, we require that all nodes maintain a record of the current amount in circulation for every issued Custom Asset, and update this record based on the issuance and burn transactions processed. This allows for efficient detection of balance violations for any Asset, in which case we specify a consensus rule to reject the transaction or block.</p>
                <p>We limit the total issuance of any Asset to a maximum of
                    <span class="math">\(\mathsf{MAX\_ISSUE}\!\)</span>
                . This is a practical limit that also allows an issuer to issue the complete supply of an Asset in a single transaction.</p>
                <p>Nodes also need to reject transactions that issue Custom Assets that have been previously finalized. The
                    <span class="math">\(\mathsf{issued\_assets}\)</span>
                 map allows nodes to store whether or not a given Asset has been finalized.</p>
            </section>
            <section id="concrete-applications"><h3><span class="section-heading">Concrete Applications</span><span class="section-anchor"> <a rel="bookmark" href="#concrete-applications"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p><strong>Asset Features</strong></p>
                <ul>
                    <li>By using the
                        <span class="math">\(\mathsf{finalize}\)</span>
                     boolean and the burning mechanism defined in <a id="footnote-reference-36" class="footnote_reference" href="#zip-0226">10</a>, issuers can control the supply production of any Asset associated to their issuer keys. For example,
                        <ul>
                            <li>by setting
                                <span class="math">\(\mathsf{finalize} = 1\)</span>
                             from the first issuance action for that Asset Identifier, the issuer is in essence creating a one-time issuance transaction. This is useful when the max supply is capped from the beginning and the distribution is known in advance. All tokens are issued at once and distributed as needed.</li>
                        </ul>
                    </li>
                    <li>Issuers can also stop the existing supply production of any Asset associated to their issuer keys. This could be done by
                        <ul>
                            <li>issuing a last set of tokens of that specific
                                <span class="math">\(\mathsf{AssetId}\!\)</span>
                            , for which
                                <span class="math">\(\mathsf{finalize} = 1\!\)</span>
                            , or by</li>
                            <li>issuing a transaction with a single note in the issuance action pertaining to that
                                <span class="math">\(\mathsf{AssetId}\!\)</span>
                            , where the note will contain a
                                <span class="math">\(\mathsf{value} = 0\!\)</span>
                            . This can be used for application-specific purposes (NFT collections) or for security purposes to revoke the Asset issuance (see Security and Privacy Considerations).</li>
                        </ul>
                    </li>
                    <li>The issuance and burn mechanisms can be used in conjunction to determine the supply of Assets on the Zcash ecosystem. This allows for the bridging of Assets defined on other chains.</li>
                    <li>Furthermore, NFT issuance is enabled by issuing in a single bundle several issuance actions, where each
                        <span class="math">\(\mathsf{AssetId}\)</span>
                     corresponds to
                        <span class="math">\(\mathsf{value} = 1\)</span>
                     at the fundamental unit level. Issuers and users should make sure that
                        <span class="math">\(\mathsf{finalize} = 1\)</span>
                     for each of the actions in this scenario.</li>
                </ul>
            </section>
        </section>
        <section id="modifications-relative-to-zip-244">
            <h2>Modifications relative to ZIP 244 <a id="footnote-reference-37" class="footnote_reference" href="#zip-0244">18</a></h2>
            <p>Relative to the sighash algorithm defined in ZIP 244, the sighash algorithm that applies to v6 transactions differs by including the issuance bundle components within the tree hash. See ZIP 246 <a id="footnote-reference-38" class="footnote_reference" href="#zip-0246">19</a> for details.</p>
        </section>
        <section id="changes-to-zip-317">
            <h2>Changes to ZIP 317 <a id="footnote-reference-39" class="footnote_reference" href="#zip-0317">20</a></h2>
            <p>The conventional fee in ZEC is altered to take into account both the presence of issuance actions within a transaction, and the creation of new Custom Assets within the global chain state. See the Fee calculation section of ZIP 317 <a id="footnote-reference-40" class="footnote_reference" href="#zip-0317-fee-calculation">21</a> for details.</p>
            <section id="rationale-for-paying-fees-in-zec"><h3><span class="section-heading">Rationale for paying fees in ZEC</span><span class="section-anchor"> <a rel="bookmark" href="#rationale-for-paying-fees-in-zec"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
            <details>
<summary>Click to show/hide</summary>
                <p>We choose to maintain the native ZEC Asset as the primary token for the Zcash blockchain, similar to how ETH is needed for ERC20 transactions to the benefit of the Ethereum ecosystem.</p>
                <p>An alternative proposal for the OrchardZSA fee mechanism that was not adopted was to adopt a new type of fee, denominated in the custom Asset being issued or transferred. In the context of transparent transactions, such a fee allows miners to “tap into” the ZSA value of the transactions, rather than the ZEC value of transactions. However when transactions are shielded, any design that lifts value from the transaction would also leak information about it.</p>
            </details></section>
        </section>
        <section id="security-and-privacy-considerations"><h2><span class="section-heading">Security and Privacy Considerations</span><span class="section-anchor"> <a rel="bookmark" href="#security-and-privacy-considerations"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <section id="displaying-asset-identifier-information-to-users"><h3><span class="section-heading">Displaying Asset Identifier information to users</span><span class="section-anchor"> <a rel="bookmark" href="#displaying-asset-identifier-information-to-users"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>Wallets need to communicate the names of the Assets in a non-confusing way to users, since the byte representation of the Asset Identifier would be hard to read for an end user. Possible solutions are provided in the <a href="#specification-asset-identifier-asset-digest-and-asset-base">Specification: Asset Identifier, Asset Digest, and Asset Base</a> section.</p>
            </section>
            <section id="issuance-key-compromise"><h3><span class="section-heading">Issuance Key Compromise</span><span class="section-anchor"> <a rel="bookmark" href="#issuance-key-compromise"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>The design of this protocol does not currently allow for rotation of the issuance validating key that would allow for replacing the key of a specific Asset. In case of compromise, the following actions are recommended:</p>
                <ul>
                    <li>If an issuance validating key is compromised, the
                        <span class="math">\(\mathsf{finalize}\)</span>
                     boolean for all the Assets issued with that key should be set to
                        <span class="math">\(1\)</span>
                     and the issuer should change to a new issuance authorizing key, and issue new Assets, each with a new
                        <span class="math">\(\mathsf{AssetId}\!\)</span>
                    .</li>
                </ul>
            </section>
            <section id="bridging-assets"><h3><span class="section-heading">Bridging Assets</span><span class="section-anchor"> <a rel="bookmark" href="#bridging-assets"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>For bridging purposes, the secure method of off-boarding Assets is to burn an Asset with the burning mechanism in ZIP 226 <a id="footnote-reference-41" class="footnote_reference" href="#zip-0226">10</a>. Users should be aware of issuers that demand the Assets be sent to a specific address on the Zcash chain to be redeemed elsewhere, as this may not reflect the real reserve value of the specific Wrapped Asset.</p>
            </section>
        </section>
        <section id="other-considerations"><h2><span class="section-heading">Other Considerations</span><span class="section-anchor"> <a rel="bookmark" href="#other-considerations"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <section id="implementing-zcash-nodes"><h3><span class="section-heading">Implementing Zcash Nodes</span><span class="section-anchor"> <a rel="bookmark" href="#implementing-zcash-nodes"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h3>
                <p>Although not enforced in the global state, it is RECOMMENDED that Zcash full validators keep track of the total supply of Assets as a mutable mapping
                    <span class="math">\(\mathsf{issuanceSupplyInfoMap}\)</span>
                 from
                    <span class="math">\(\mathsf{AssetId}\)</span>
                 to
                    <span class="math">\((\mathsf{totalSupply}, \mathsf{finalize})\)</span>
                 in order to properly keep track of the total supply for different Asset Identifiers. This is useful for wallets and other applications that need to keep track of the total supply of Assets.</p>
            </section>
        </section>
        <section id="test-vectors"><h2><span class="section-heading">Test Vectors</span><span class="section-anchor"> <a rel="bookmark" href="#test-vectors"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <ul>
                <li>LINK TBD</li>
            </ul>
        </section>
        <section id="reference-implementation"><h2><span class="section-heading">Reference Implementation</span><span class="section-anchor"> <a rel="bookmark" href="#reference-implementation"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <ul>
                <li>LINK TBD</li>
                <li>LINK TBD</li>
            </ul>
        </section>
        <section id="deployment"><h2><span class="section-heading">Deployment</span><span class="section-anchor"> <a rel="bookmark" href="#deployment"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <p>TBD</p>
        </section>
        <section id="references"><h2><span class="section-heading">References</span><span class="section-anchor"> <a rel="bookmark" href="#references"><img width="24" height="24" class="section-anchor" src="assets/images/section-anchor.png" alt=""></a></span></h2>
            <table id="bcp14" class="footnote">
                <tbody>
                    <tr>
                        <th>1</th>
                        <td><a href="https://www.rfc-editor.org/info/bcp14">Information on BCP 14 — "RFC 2119: Key words for use in RFCs to Indicate Requirement Levels" and "RFC 8174: Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0032" class="footnote">
                <tbody>
                    <tr>
                        <th>2</th>
                        <td><a href="zip-0032.html">ZIP 32: Shielded Hierarchical Deterministic Wallets</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0032-hardened-only-key-derivation" class="footnote">
                <tbody>
                    <tr>
                        <th>3</th>
                        <td><a href="zip-0032.html#specification-hardened-only-key-derivation">ZIP 32: Shielded Hierarchical Deterministic Wallets - Specification: Hardened-only key derivation</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0032-hardened-only-child-key-derivation" class="footnote">
                <tbody>
                    <tr>
                        <th>4</th>
                        <td><a href="zip-0032.html#hardened-only-child-key-derivation">ZIP 32: Shielded Hierarchical Deterministic Wallets - Hardened-only child key derivation</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0032-key-path-levels" class="footnote">
                <tbody>
                    <tr>
                        <th>5</th>
                        <td><a href="zip-0032.html#key-path-levels">ZIP 32: Shielded Hierarchical Deterministic Wallets - Key path levels</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0032-orchard-key-path" class="footnote">
                <tbody>
                    <tr>
                        <th>6</th>
                        <td><a href="zip-0032.html#orchard-key-path">ZIP 32: Shielded Hierarchical Deterministic Wallets - Orchard key path</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0200" class="footnote">
                <tbody>
                    <tr>
                        <th>7</th>
                        <td><a href="zip-0200.html">ZIP 200: Network Upgrade Mechanism</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0209" class="footnote">
                <tbody>
                    <tr>
                        <th>8</th>
                        <td><a href="zip-0209.html">ZIP 209: Prohibit Negative Shielded Chain Value Pool Balances</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0224" class="footnote">
                <tbody>
                    <tr>
                        <th>9</th>
                        <td><a href="zip-0224.html">ZIP 224: Orchard</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0226" class="footnote">
                <tbody>
                    <tr>
                        <th>10</th>
                        <td><a href="zip-0226.html">ZIP 226: Transfer and Burn of Zcash Shielded Assets</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0226-notestructure" class="footnote">
                <tbody>
                    <tr>
                        <th>11</th>
                        <td><a href="zip-0226.html#note-structure-commitment">ZIP 226: Transfer and Burn of Zcash Shielded Assets - Note Structure &amp; Commitment</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0226-assetburn" class="footnote">
                <tbody>
                    <tr>
                        <th>12</th>
                        <td><a href="zip-0226.html#additional-consensus-rules-for-the-assetburn-set">ZIP 226: Transfer and Burn of Zcash Shielded Assets - Additional Consensus Rules for the assetBurn set</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0226-txiddigest" class="footnote">
                <tbody>
                    <tr>
                        <th>13</th>
                        <td><a href="zip-0226.html#txid-digest">ZIP 226: Transfer and Burn of Zcash Shielded Assets - TxId Digest</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0226-authcommitment" class="footnote">
                <tbody>
                    <tr>
                        <th>14</th>
                        <td><a href="zip-0226.html#authorizing-data-commitment">ZIP 226: Transfer and Burn of Zcash Shielded Assets - Authorizing Data Commitment</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0230-issuance-action-description" class="footnote">
                <tbody>
                    <tr>
                        <th>15</th>
                        <td><a href="zip-0230.html#issuance-action-description-issueaction">ZIP 230: Version 6 Transaction Format: Issuance Action Description (IssueAction)</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0230-issue-note" class="footnote">
                <tbody>
                    <tr>
                        <th>16</th>
                        <td><a href="zip-0230.html#issue-note-description-issuenote">ZIP 230: Version 6 Transaction Format: Issue Note (IssueNote)</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0230-transaction-format" class="footnote">
                <tbody>
                    <tr>
                        <th>17</th>
                        <td><a href="zip-0230.html#transaction-format">ZIP 230: Version 6 Transaction Format: Transaction Format</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0244" class="footnote">
                <tbody>
                    <tr>
                        <th>18</th>
                        <td><a href="zip-0244.html">ZIP 244: Transaction Identifier Non-Malleability</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0246" class="footnote">
                <tbody>
                    <tr>
                        <th>19</th>
                        <td><a href="zip-0246.html">ZIP 246: Digests for the Version 6 Transaction Format</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0317" class="footnote">
                <tbody>
                    <tr>
                        <th>20</th>
                        <td><a href="zip-0317.html">ZIP 317: Proportional Transfer Fee Mechanism</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="zip-0317-fee-calculation" class="footnote">
                <tbody>
                    <tr>
                        <th>21</th>
                        <td><a href="zip-0317.html#fee-calculation">ZIP 317: Proportional Transfer Fee Mechanism - Fee calculation</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="bip-0043" class="footnote">
                <tbody>
                    <tr>
                        <th>22</th>
                        <td><a href="https://github.com/bitcoin/bips/blob/master/bip-0043.mediawiki">BIP 43: Purpose Field for Deterministic Wallets</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="bip-0340" class="footnote">
                <tbody>
                    <tr>
                        <th>23</th>
                        <td><a href="https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki">BIP 340: Schnorr Signatures for secp256k1</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-notation" class="footnote">
                <tbody>
                    <tr>
                        <th>24</th>
                        <td><a href="protocol/protocol.pdf#notation">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 2: Notation</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-addressesandkeys" class="footnote">
                <tbody>
                    <tr>
                        <th>25</th>
                        <td><a href="protocol/protocol.pdf#addressesandkeys">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 3.1: Payment Addresses and Keys</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-notes" class="footnote">
                <tbody>
                    <tr>
                        <th>26</th>
                        <td><a href="protocol/protocol.pdf#notes">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 3.2: Notes</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-abstractsig" class="footnote">
                <tbody>
                    <tr>
                        <th>27</th>
                        <td><a href="protocol/protocol.pdf#abstractsig">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 4.1.7: Signature</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-orchardkeycomponents" class="footnote">
                <tbody>
                    <tr>
                        <th>28</th>
                        <td><a href="protocol/protocol.pdf#orchardkeycomponents">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 4.2.3: Orchard Key Components</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-sighash" class="footnote">
                <tbody>
                    <tr>
                        <th>29</th>
                        <td><a href="protocol/protocol.pdf#sighash">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 4.10: SIGHASH Transaction Hashing</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-constants" class="footnote">
                <tbody>
                    <tr>
                        <th>30</th>
                        <td><a href="protocol/protocol.pdf#constants">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 5.3: Constants</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-concreteprfs" class="footnote">
                <tbody>
                    <tr>
                        <th>31</th>
                        <td><a href="protocol/protocol.pdf#concreteprfs">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 5.4.2: Pseudo Random Functions</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-concretegrouphashpallasandvesta" class="footnote">
                <tbody>
                    <tr>
                        <th>32</th>
                        <td><a href="protocol/protocol.pdf#concretegrouphashpallasandvesta">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 5.4.9.8: Group Hash into Pallas and Vesta</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-orchardpaymentaddrencoding" class="footnote">
                <tbody>
                    <tr>
                        <th>33</th>
                        <td><a href="protocol/protocol.pdf#orchardpaymentaddrencoding">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 5.6.4.2: Orchard Raw Payment Addresses</a></td>
                    </tr>
                </tbody>
            </table>
            <table id="protocol-txnencoding" class="footnote">
                <tbody>
                    <tr>
                        <th>34</th>
                        <td><a href="protocol/protocol.pdf#txnencoding">Zcash Protocol Specification, Version 2024.5.1 [NU6]. Section 7.1: Transaction Encoding and Consensus</a></td>
                    </tr>
                </tbody>
            </table>
        </section>
    </section>
</body>
</html>